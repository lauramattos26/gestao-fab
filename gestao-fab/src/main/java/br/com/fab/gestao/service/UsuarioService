package br.com.fab.gestao.service; 

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import br.com.fab.gestao.repository.UsuarioRepository; 
import br.com.fab.gestao.model.Usuario; 
import br.com.fab.gestao.model.Perfil; 
import java.util.Optional;

@Service
public class UsuarioService {

    @Autowired
    private UsuarioRepository usuarioRepository;

    public Usuario registrarUsuario(Usuario novoUsuario) {
        if (usuarioRepository.existsByLogin(novoUsuario.getLogin())) {
            throw new RuntimeException("Login já está em uso.");
        }

        if (novoUsuario.getPerfil() == null) {
            novoUsuario.setPerfil(Perfil.ALUNO);
        }

        return usuarioRepository.save(novoUsuario);
    }

    public Optional<Usuario> buscarPorId(Long id) {
        return usuarioRepository.findById(id);
    }

    public Optional<Usuario> buscarPorLogin(String login) {
        return usuarioRepository.findByLogin(login);
    }
}